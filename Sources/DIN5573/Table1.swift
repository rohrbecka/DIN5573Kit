//
//  Table1.swift
//  
//
//  Created by André Rohrbeck on 16.01.23.
//

import Foundation

// swiftlint:disable comma

/// The content of *Table 1: Coordinates of the Profile E* between the head of the flange and the outer wheel face.
/// The co-ordinates are independent on the wheel back distance.
///
enum Table1 {

    internal static func profile(sr: Int) -> [CGPoint] {
        assert(DIN5573.validSR.contains(sr))
        return zip(xCoords, table1(sr: sr)).map {CGPoint(x: $0.0, y: $0.1)}
    }



    internal static func profile(width: Int, sr: Int) -> [CGPoint] {
        assert(DIN5573.validSR.contains(sr))
        assert(DIN5573.validWidth.contains(width))
        switch width {
        case 135:
            let table = table1a(sr: sr)
            return stride(from: 61, through: 65, by: 1).map {
                CGPoint(x: Double($0), y: table[$0-61])
            }
        case 140:
            let table = table1b(sr: sr)
            return stride(from: 61, through: 70, by: 1).map {
                CGPoint(x: Double($0), y: table[$0-61])
            }
        default: fatalError("This should not happen...")
        }
    }


    private static func table1(sr: Int) -> [Double] {
        assert(DIN5573.validSR.contains(sr))
        switch sr {
        case 1427: return table1_1427
        case 1426: return table1_1426
        case 1425: return table1_1425
        case 1424: return table1_1424
        case 1423: return table1_1423
        case 1422: return table1_1422
        case 1421: return table1_1421
        case 1420: return table1_1420
        default: fatalError("This should not happen...")
        }
    }


    private static func table1a(sr: Int) -> [Double] {
        assert(DIN5573.validSR.contains(sr))
        switch sr {
        case 1425: return table1a_1425
        default: fatalError("This should not happen...")
        }
    }


    private static func table1b(sr: Int) -> [Double] {
        assert(DIN5573.validSR.contains(sr))
        switch sr {
        case 1425: return table1b_1425
        default: fatalError("This should not happen...")
        }
    }



    /// The content of table 1a for a Spurmaß of 1427 mm.
    /// The values are given from -60 to -22 mm lateral position in 0.5-mm-steps,
    /// and from 22 mm to 60 mm in 1-mm-steps.
    private static let table1_1427 = [27.96,
                                      27.96, 27.96, 27.96, 27.96, 27.96, 27.96, 27.96, 27.96, 27.96, 27.96,
                                      27.96, 27.96, 27.95, 27.92, 27.87, 27.80, 27.71, 27.59, 27.45, 27.29,
                                      27.10, 26.88, 26.64, 26.38, 26.10, 25.80, 25.48, 25.14, 24.77, 24.38,
                                      23.97, 23.52, 23.04, 22.53, 21.98, 21.39, 20.75, 20.05, 19.27, 18.41,
                                      17.44, 16.31, 14.97, 13.60, 12.22, 10.98, 10.00,  9.19,  8.49,  7.88,
                                       7.34,  6.85,  6.41,  6.02,  5.66,  5.33,  5.04,  4.77,  4.52,  4.29,
                                       4.09,  3.89,  3.71,  3.55,  3.39,  3.24,  3.10,  2.96,  2.83,  2.71,
                                       2.59,  2.48,  2.37,  2.26,  2.16,  2.07,  1.89,  1.72,  1.56,
                                       1.42,  1.28,  1.16,  1.04,  0.93,  0.83,  0.74,  0.65,  0.57,
                                       0.49,  0.42,  0.35,  0.29,  0.23,  0.18,  0.13,  0.08,  0.04,
                                       0.00,
                                      -0.04, -0.07, -0.10, -0.12, -0.15, -0.17, -0.19, -0.20, -0.22,
                                      -0.23, -0.24, -0.25, -0.26, -0.27, -0.28, -0.29, -0.30, -0.31, -0.32,
                                      -0.33, -0.35, -0.36, -0.38, -0.41, -0.43, -0.46, -0.50, -0.53, -0.58,
                                      -0.63, -0.68, -0.74, -0.80, -0.87, -0.94, -1.00, -1.07, -1.14, -1.20,
                                      -1.27, -1.34, -1.40, -1.47, -1.54, -1.60, -1.67, -1.74, -1.80, -1.87,
                                      -1.94, -2.00, -2.07, -2.14, -2.20, -2.27, -2.34, -2.40, -2.47, -2.54,
                                      -2.60]

    /// The content of table 1a for a Spurmaß of 1427 mm.
    /// The values are given from -60 to -22 mm lateral position in 0.5-mm-steps,
    /// and from 22 mm to 60 mm in 1-mm-steps.
    private static let table1_1426 = [27.98,
                                      27.98, 27.98, 27.98, 27.98, 27.98, 27.98, 27.98, 27.98, 27.98, 27.98,
                                      27.98, 27.97, 27.94, 27.89, 27.82, 27.72, 27.60, 27.46, 27.30, 27.11,
                                      26.90, 26.65, 26.39, 26.11, 25.81, 25.49, 25.15, 24.78, 24.39, 23.97,
                                      23.53, 23.05, 22.54, 21.99, 21.40, 20.75, 20.05, 19.27, 18.41, 17.43,
                                      16.30, 14.96, 13.58, 12.21, 10.97, 10.00,  9.19,  8.50,  7.89,  7.34,
                                       6.86,  6.42,  6.03,  5.67,  5.35,  5.05,  4.78,  4.53,  4.31,  4.10,
                                       3.91,  3.73,  3.56,  3.40,  3.26,  3.11,  2.98,  2.85,  2.73,  2.61,
                                       2.49,  2.39,  2.28,  2.18,  2.08,  1.99,  1.82,  1.66,  1.51,
                                       1.37,  1.24,  1.12,  1.00,  0.90,  0.80,  0.71,  0.62,  0.54,
                                       0.47,  0.40,  0.34,  0.28,  0.22,  0.17,  0.12,  0.08,  0.04,
                                       0.00,
                                      -0.03, -0.06, -0.09, -0.12, -0.14, -0.16, -0.18, -0.19, -0.21,
                                      -0.22, -0.23, -0.24, -0.25, -0.26, -0.27, -0.28, -0.29, -0.30, -0.31,
                                      -0.32, -0.34, -0.35, -0.38, -0.40, -0.43, -0.46, -0.50, -0.54, -0.58,
                                      -0.64, -0.69, -0.75, -0.82, -0.89, -0.95, -1.02, -1.09, -1.15, -1.22,
                                      -1.29, -1.35, -1.42, -1.49, -1.55, -1.62, -1.69, -1.75, -1.82, -1.89,
                                      -1.95, -2.02, -2.09, -2.15, -2.22, -2.29, -2.35, -2.42, -2.49, -2.55,
                                      -2.62]

    /// The content of table 1a for a Spurmaß of 1425 mm.
    /// The values are given from -60 to -22 mm lateral position in 0.5-mm-steps,
    /// and from 22 mm to 60 mm in 1-mm-steps.
    private static let table1_1425 = [28.00,
                                      28.00, 28.00, 28.00, 28.00, 28.00, 28.00, 28.00, 28.00, 28.00, 28.00,
                                      27.99, 27.96, 27.91, 27.83, 27.74, 27.62, 27.48, 27.31, 27.12, 26.91,
                                      26.67, 26.40, 26.12, 25.82, 25.50, 25.16, 24.79, 24.40, 23.98, 23.54,
                                      23.06, 22.55, 22.00, 21.40, 20.76, 20.05, 19.28, 18.41, 17.43, 16.29,
                                      14.95, 13.57, 12.20, 10.97, 10.00,  9.19,  8.50,  7.89,  7.35,  6.87,
                                       6.43,  6.04,  5.68,  5.36,  5.06,  4.79,  4.55,  4.32,  4.11,  3.92,
                                       3.74,  3.58,  3.42,  3.27,  3.13,  2.99,  2.86,  2.74,  2.62,  2.51,
                                       2.40,  2.30,  2.20,  2.10,  2.01,  1.92,  1.75,  1.60,  1.45,
                                       1.32,  1.19,  1.08,  0.97,  0.87,  0.77,  0.68,  0.60,  0.52,
                                       0.45,  0.38,  0.32,  0.26,  0.21,  0.16,  0.12,  0.07,  0.04,
                                       0.00,
                                      -0.03, -0.06, -0.09, -0.11, -0.13, -0.15, -0.17, -0.18, -0.20,
                                      -0.21, -0.22, -0.23, -0.24, -0.25, -0.26, -0.26, -0.27, -0.29, -0.30,
                                      -0.31, -0.33, -0.35, -0.37, -0.40, -0.43, -0.46, -0.50, -0.54, -0.59,
                                      -0.65, -0.71, -0.77, -0.84, -0.90, -0.97, -1.04, -1.10, -1.17, -1.24,
                                      -1.30, -1.37, -1.44, -1.50, -1.57, -1.64, -1.70, -1.77, -1.84, -1.90,
                                      -1.97, -2.04, -2.10, -2.17, -2.24, -2.30, -2.37, -2.44, -2.50, -2.57,
                                      -2.64]


    /// The content of table 1a for a Spurmaß of 1424 mm.
    /// The values are given from -60 to -22 mm lateral position in 0.5-mm-steps,
    /// and from 22 mm to 60 mm in 1-mm-steps.
    private static let table1_1424 = [28.01,
                                      28.01, 28.01, 28.01, 28.01, 28.01, 28.01, 28.01, 28.01, 28.01, 28.01,
                                      27.97, 27.92, 27.85, 27.75, 27.63, 27.49, 27.33, 27.14, 26.92, 26.68,
                                      26.41, 26.13, 25.83, 25.51, 25.17, 24.80, 24.41, 23.99, 23.55, 23.07,
                                      22.55, 22.00, 21.41, 20.76, 20.05, 19.28, 18.41, 17.43, 16.28, 14.94,
                                      13.57, 12.19, 10.96, 10.00,  9.20,  8.51,  7.90,  7.36,  6.88,  6.44,
                                       6.05,  5.69,  5.37,  5.07,  4.80,  4.56,  4.33,  4.13,  3.93,  3.76,
                                       3.59,  3.43,  3.28,  3.14,  3.01,  2.88,  2.76,  2.64,  2.52,  2.42,
                                       2.31,  2.21,  2.12,  2.02,  1.93,  1.85,  1.69,  1.54,  1.40,
                                       1.27,  1.15,  1.04,  0.93,  0.83,  0.74,  0.66,  0.58,  0.50,
                                       0.43,  0.37,  0.31,  0.25,  0.20,  0.15,  0.11,  0.07,  0.03,
                                       0.00,
                                      -0.03, -0.06, -0.08, -0.11, -0.13, -0.14, -0.16, -0.17, -0.19,
                                      -0.20, -0.21, -0.22, -0.23, -0.23, -0.24, -0.25, -0.26, -0.27, -0.29,
                                      -0.30, -0.32, -0.34, -0.37, -0.39, -0.43, -0.46, -0.50, -0.55, -0.60,
                                      -0.66, -0.72, -0.79, -0.85, -0.92, -0.99, -1.05, -1.12, -1.19, -1.25,
                                      -1.32, -1.39, -1.45, -1.52, -1.59, -1.65, -1.72, -1.79, -1.85, -1.92,
                                      -1.99, -2.05, -2.12, -2.19, -2.25, -2.32, -2.39, -2.45, -2.52, -2.59,
                                      -2.65]


    /// The content of table 1a for a Spurmaß of 1423 mm.
    /// The values are given from -60 to -22 mm lateral position in 0.5-mm-steps,
    /// and from 22 mm to 60 mm in 1-mm-steps.
    private static let table1_1423 = [28.02,
                                      28.02, 28.02, 28.02, 28.02, 28.02, 28.02, 28.02, 28.02, 28.01, 27.99,
                                      27.94, 27.86, 27.77, 27.65, 27.51, 27.34, 27.15, 26.93, 26.69, 26.43,
                                      26.14, 25.84, 25.52, 25.18, 24.81, 24.42, 24.00, 23.55, 23.07, 22.56,
                                      22.01, 21.41, 20.76, 20.06, 19.28, 18.41, 17.42, 16.28, 14.93, 13.56,
                                      12.18, 10.96, 10.00,  9.20,  8.51,  7.90,  7.37,  6.88,  6.45,  6.06,
                                       5.70,  5.38,  5.08,  4.82,  4.57,  4.35,  4.14,  3.95,  3.77,  3.60,
                                       3.45,  3.30,  3.16,  3.02,  2.89,  2.77,  2.65,  2.54,  2.43,  2.33,
                                       2.23,  2.13,  2.04,  1.95,  1.86,  1.78,  1.63,  1.48,  1.35,
                                       1.22,  1.11,  1.00,  0.90,  0.80,  0.71,  0.63,  0.55,  0.48,
                                       0.42,  0.35,  0.30,  0.24,  0.19,  0.15,  0.11,  0.07,  0.03,
                                       0.00,
                                      -0.03, -0.06, -0.08, -0.10, -0.12, -0.14, -0.15, -0.16, -0.18,
                                      -0.19, -0.20, -0.21, -0.21, -0.22, -0.23, -0.24, -0.25, -0.27, -0.28,
                                      -0.30, -0.32, -0.34, -0.36, -0.39, -0.43, -0.47, -0.51, -0.56, -0.61,
                                      -0.67, -0.74, -0.80, -0.87, -0.94, -1.00, -1.07, -1.14, -1.20, -1.27,
                                      -1.34, -1.40, -1.47, -1.54, -1.60, -1.67, -1.74, -1.80, -1.87, -1.94,
                                      -2.00, -2.07, -2.14, -2.20, -2.27, -2.34, -2.40, -2.47, -2.54, -2.60,
                                      -2.67]


    private static let table1_1422 = [28.04,
                                      28.04, 28.04, 28.04, 28.04, 28.04, 28.04, 28.04, 28.03, 28.00, 27.95,
                                      27.88, 27.78, 27.66, 27.52, 27.35, 27.16, 26.94, 26.70, 26.44, 26.15,
                                      25.85, 25.53, 25.19, 24.82, 24.43, 24.01, 23.56, 23.08, 22.57, 22.01,
                                      21.42, 20.77, 20.06, 19.28, 18.41, 17.42, 16.27, 14.92, 13.55, 12.17,
                                      10.96, 10.00,  9.20,  8.51,  7.91,  7.37,  6.89,  6.46,  6.07,  5.71,
                                       5.39,  5.09,  4.83,  4.58,  4.36,  4.15,  3.96,  3.78,  3.61,  3.46,
                                       3.31,  3.17,  3.03,  2.91,  2.78,  2.66,  2.55,  2.44,  2.34,  2.24,
                                       2.14,  2.05,  1.96,  1.88,  1.80,  1.72,  1.57,  1.43,  1.30,
                                       1.18,  1.07,  0.96,  0.86,  0.77,  0.69,  0.61,  0.53,  0.46,
                                       0.40,  0.34,  0.28,  0.23,  0.18,  0.14,  0.10,  0.06,  0.03,
                                       0.00,
                                      -0.03, -0.05, -0.07, -0.09, -0.11, -0.13, -0.14, -0.16, -0.17,
                                      -0.18, -0.19, -0.19, -0.20, -0.21, -0.22, -0.23, -0.24, -0.26, -0.27,
                                      -0.29, -0.31, -0.34, -0.36, -0.40, -0.43, -0.47, -0.52, -0.57, -0.63,
                                      -0.69, -0.76, -0.82, -0.89, -0.96, -1.02, -1.09, -1.16, -1.22, -1.29,
                                      -1.36, -1.42, -1.49, -1.56, -1.62, -1.69, -1.76, -1.82, -1.89, -1.96,
                                      -2.02, -2.09, -2.16, -2.22, -2.29, -2.36, -2.42, -2.49, -2.56, -2.62,
                                      -2.69]


    private static let table1_1421 = [28.06,
                                      28.06, 28.06, 28.06, 28.06, 28.06, 28.06, 28.05, 28.02, 27.96, 27.89,
                                      27.79, 27.67, 27.53, 27.36, 27.17, 26.95, 26.71, 26.45, 26.16, 25.86,
                                      25.54, 25.19, 24.83, 24.43, 24.01, 23.57, 23.09, 22.57, 22.02, 21.42,
                                      20.77, 20.06, 19.28, 18.41, 17.42, 16.26, 14.91, 13.54, 12.17, 10.95,
                                      10.00,  9.20,  8.52,  7.91,  7.38,  6.90,  6.46,  6.07,  5.72,  5.40,
                                       5.10,  4.84,  4.59,  4.37,  4.16,  3.97,  3.79,  3.63,  3.47,  3.32,
                                       3.18,  3.05,  2.92,  2.79,  2.68,  2.56,  2,46,  2.35,  2.25,  2.16,
                                       2.06,  1.98,  1.89,  1.81,  1.73,  1.65,  1.51,  1.38,  1.25,
                                      1.13,  1.03,  0.92,  0.83,  0.74,  0.66,  0.58,  0.51,  0.44,
                                      0.38,  0.32,  0.27,  0.22, 0.18,  0.13,  0.10,  0.06,  0.03,
                                      0.00,
                                      -0.03, -0.05, -0.07, -0.09, -0.11, -0.12, -0.13, -0.15, -0.16,
                                      -0.17, -0.18, -0.19, -0.19, -0.20, -0.21, -0.22, -0.24, -0.25, -0.27,
                                      -0.29, -0.31, -0.33, -0.36, -0.40, -0.44, -0.48, -0.53, -0.59, -0.65,
                                      -0.71, -0.78, -0.84, -0.91, -0.98, -1.04, -1.11, -1.18, -1,24, -1.31,
                                      -1.38, -1.44, -1.51, -1.58, -1.64, -1.71, -1.78, -1.84, -1.91, -1.98,
                                      -2.04, -2.11, -2.18, -2.24, -2.31, -2.38, -2.44, -2.51, -2.58, -2.64,
                                      -2.71]


    private static let table1_1420 = [28.08,
                                      28.08, 28.08, 28.08, 28.08, 28.08, 28.06, 28.03, 27.98, 27.90, 27.80,
                                      27.68, 27.54, 27.37, 27.18, 26.96, 26.72, 26.46, 26.17, 25.87, 25.55,
                                      25.20, 24.83, 24.44, 24.02, 23.57, 23.09, 22.58, 22.02, 21.42, 20.77,
                                      20.06, 19.28, 18.41, 17.42, 16.26, 14.90, 13.53, 12.16, 10.95, 10.00,
                                       9.21,  8.52,  7.92,  7.38,  6.90,  6.47,  6.08,  5.73,  5.41,  5.11,
                                       4.85,  4.60,  4.38,  4.17,  3.98,  3.80,  3.64,  3.48,  3.33,  3.19,
                                       3.06,  2.93,  2.81,  2.69,  2.58,  2.47,  2.36,  2.26,  2.17,  2.08,
                                       1.99,  1.90,  1.82,  1.74,  1.67,  1.59,  1.45,  1.32,  1.20,
                                       1.09,  0.99,  0.89,  0.80,  0.71,  0.63,  0.56,  0.49,  0.43,
                                       0.37,  0.31,  0.26,  0.21,  0.17,  0.13,  0.09,  0.06,  0.03,
                                       0.00,
                                      -0.02, -0.05, -0.07, -0.08, -0.10, -0.11, -0.13, -0.14, -0.15,
                                      -0.16, -0.17, -0.18, -0.18, -0.19, -0.20, -0.22, -0.23, -0.24, -0.26,
                                      -0.28, -0.31, -0.34, -0.37, -0.41, -0.45, -0.49, -0.55, -0.60, -0.66,
                                      -0.73, -0.80, -0.86, -0.93, -1.00, -1.06, -1.13, -1.20, -1.26, -1.33,
                                      -1.40, -1.46, -1.53, -1.60, -1.66, -1.73, -1.80, -1.86, -1.93, -2.00,
                                      -2.06, -2.13, -2.20, -2.26, -2.33, -2.40, -2.46, -2.53, -2.60, -2.66,
                                      -2.73]

    private static let table1a_1425 = [-3.64, -4.64, -5.64, -6.64, -7.64]


    private static let table1b_1425 = [-2.70, -2.77, -2.84, -2.90, -2.97,
                                        -3.97, -4.97, -5.97, -6.97, -7.97]


    private static var xCoords: [Double] = {
        let part1 = stride(from: -60.0, to: -22.0, by: 0.5).map {$0}
        let part2 = stride(from: -22.0, through: 60.0, by: 1.0).map {$0}
        return part1 + part2
    }()
}
